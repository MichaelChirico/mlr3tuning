---
title: "Introduction to Tuner"
author: "Daniel Schalk"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Introduction to Tuner}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
library(mlr3tuning)
knitr::opts_knit$set(
  datatable.print.keys = FALSE,
  datatable.print.class = TRUE
)
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
set.seed(123)
```

`mlr3tuning` is an extension of `mlr3` that includes tuning.

## Basis of Tuning 

As mentioned in the `tuning-01-fitness-function` vignette, we have to define a `[FitnessFunction]` object to define the hyperparameter space as well as the evaluation technique that is used to estimate the generalization error:

```{r}
task = mlr3::mlr_tasks$get("iris")
learner = mlr3::mlr_learners$get("classif.rpart")
resampling = mlr3::mlr_resamplings$get("holdout")
measures = mlr3::mlr_measures$mget("mmce")
param_set = paradox::ParamSet$new(params = list(paradox::ParamDbl$new("cp", lower = 0.001, upper = 0.1)))

ff = FitnessFunction$new(task, learner, resampling, measures, param_set)
```

## Define a Terminator

```{r}
terminator = TerminatorEvaluations$new(5)
```

## Basic Search Strategies

### Conduct Random Search

```{r}
rs = TunerRandomSearch$new(ff, terminator)
rs$tune()
rs$tune_result()
```

### Conduct Grid Search

```{r}
# gs = TunerGridSearch$new(ff, terminator)
# gs$tune()
# gs$tune_result()
```

## Train Final Model

On basis of the random search results we want to train a final model using the complete dataset:

```{r}
rs_result = rs$tune_result()

```